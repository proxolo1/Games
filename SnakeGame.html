<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body bgcolor="#0000">
    <div align="center" style="margin: 30px;">
        <canvas id="canvas" width="500" height="500" style="border: 1px solid rgb(255, 255, 255)"></canvas>
        <br>
        <h1 align="center" style="background-color:rgb(23, 196, 219)">Score is :<span id="score"></span></h1>

    </div>
    <script>
        const canvas = document.getElementById("canvas")
        const ctx = canvas.getContext("2d")
        let snake = [{ x: 10, y: 10 }]
        let canvasW = canvas.width
        let canvasH = canvas.height
        let snakeW=snakeH= 10,interval,head,dx=10,dy=0,leftPressed=rightPressed=downPressed=upPressed=false,foodX,foodY,score=0
        document.getElementById('score').innerHTML =score
        drawSnake()
        randomFood()
        snakeNavigation()
        moveSnake()
        function drawSnake() {
            snake.forEach(snake => {
                ctx.beginPath()
                ctx.rect(snake.x, snake.y, snakeW, snakeH)
                ctx.fillStyle = "red"
                ctx.fill()
                ctx.closePath()
            })
        }
        function moveSnake(){
            interval = setInterval(()=>{
                snakeDirection()
               snakeContinue()
                head={x:snake[0].x+dx, y:snake[0].y+dy}
                snake.unshift(head)
                snake.pop()
                ctx.clearRect(0, 0, canvasW, canvasH)
                snakeGrow()
                drawSnake()
                drawFood()
                gameOver()
            },100)
        }
        function snakeContinue(){
            if(snake[0].x===canvasW){
                    //snake = [{ x: snakeW, y: snake[0].y }]
                    head={x:snakeW, y:snake[0].y}
                snake.unshift(head)
                snake.pop()
                }
                if(snake[0].x===0){
                  //  snake = [{ x: canvasW, y: snake[0].y }]
                    head={x:canvasW, y:snake[0].y}
                snake.unshift(head)
                snake.pop()
                }
                if(snake[0].y===canvasH){
                   // snake = [{ x: snake[0].x, y:snakeH}]
                   head={x:snake[0].x, y:snakeH}
                snake.unshift(head)
                snake.pop()
                }
                if(snake[0].y===0){
                   // snake = [{ x: snake[0].x, y: canvasH }]
                   head={x:snake[0].x, y:canvasH}
                snake.unshift(head)
                snake.pop()
                }
        }
        function snakeNavigation() {
            document.addEventListener('keydown',handleKeyDown)
            //document.addEventListener('keyup',handleKeyUp)
            function handleKeyDown(e){
                if(!upPressed){
                if (e.key === 'ArrowDown'||e.key === 's') { downPressed = true;upPressed = false;leftPressed=false;rightPressed=false}}
                if(!downPressed){
                if (e.key === 'ArrowUp'||e.key === 'w') { upPressed = true;downPressed = false;leftPressed=false;rightPressed= false}}
                if(!rightPressed){
                if (e.key === 'ArrowLeft'||e.key === 'a') { leftPressed = true;downPressed=false;upPressed= false;rightPressed= false}}
                if(!leftPressed){
                if (e.key === 'ArrowRight'||e.key === 'd') { rightPressed = true;leftPressed=false;upPressed=false;downPressed= false}}
            }
            // function handleKeyUp(e){
            //     if (e.key === 'ArrowDown'||e.key === 's') { downPressed = false }
            //     if (e.key === 'ArrowUp'||e.key === 'w') { upPressed = false }
            //     if (e.key === 'ArrowLeft'||e.key === 'a') { leftPressed = false }
            //     if (e.key === 'ArrowRight'||e.key === 'd') { rightPressed = false }
            // }
        }
        function snakeDirection(){
           
            if(downPressed){ 
                dy=snakeW
                dx=0
                
            }
            if(upPressed){ 
                dy=-snakeW
                dx=0
            }
            if(leftPressed){  
                dy=0
                dx=-snakeW
            }
            if(rightPressed){ 
                dy=0
                dx=snakeW
            }
        }
        function drawFood(){
            ctx.beginPath()
            ctx.rect(foodX,foodY,snakeW,snakeH)
            ctx.fillStyle="yellow"
            ctx.fill()
            ctx.closePath()
        }
        function randomFood(){
            foodX=Math.floor(Math.random()*canvasW/10)* 10
            foodY=Math.floor(Math.random()*canvasH/10)* 10
        }
        function snakeGrow(){
            if(snake[0].x===foodX&&snake[0].y===foodY){
                snake.push({x:foodX,y:foodY})
                randomFood()
                score +=2
                document.getElementById('score').innerHTML=score
            }
        }
        function gameOver(){
           
            snake.forEach(snake=>{
                console.log(snake)
             
            })
        }
    </script>
</body>

</html>
